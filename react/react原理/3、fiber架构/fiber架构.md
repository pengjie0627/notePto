1、什么是fiber架构？
```
1、从运行机制上来解释，fiber是一种流程让出机制，它能让react中的同步渲染进行中断，并将渲染的控制权让回浏览器，从而达到不阻塞浏览器渲染的目的。
2、从数据角度来解释，fiber能细化成一种数据结构，或者一个执行单元。
```
2、为什么要有fiber架构？
```
在react16.x版本，render函数是采用递归方式对虚拟dom进行逐级渲染的，渲染过程中没法中断。在浏览器中，页面是一帧一帧绘制出来的，
一般情况下设备的屏幕刷新率为60HZ（ 代表1s 60 次），每帧绘制大概需要 16ms。在这一帧中浏览器要完成很多事情！
如果在某个阶段执行任务特别长，时间已经明显超过了 16ms，那么就会阻塞页面的渲染，从而出现卡顿现象，也就是常说的掉帧！
为了解决以上的痛点问题，React 希望能够彻底解决主线程长时间占用问题，于是引入了 Fiber 架构
```

3、fiber架构的实现原理？
```
在代码层面，Fiber的实现主要体现在以下几个方面：

1、Fiber节点结构：每个组件在React Fiber架构中对应一个Fiber节点，这些节点构成了一个Fiber树（有时称为“链表”结构）。每个Fiber节点包含了对组件的描述、当前状态、子节点引用等信息。

2、双缓存技术：React使用双缓存（也称为“双重缓冲”）技术来避免在更新过程中直接修改DOM。具体来说，当开始一个新的更新时，React会构建一个全新的Fiber树，然后通过DOM diff算法比较新旧树的区别，最后一次性将差异应用到DOM上。这样可以显著减少DOM操作的数量，提高性能。

3、调度循环：React使用调度循环来决定何时以及如何执行任务。这包括使用requestIdleCallback来在浏览器空闲时执行工作，以及使用requestAnimationFrame来安排下一次渲染的时间。

4、通过这些机制，Fiber架构使得React能够更高效地处理复杂的UI更新和动画，提高了应用的响应性和性能。


```
4、fiber能做什么？
```
1. 任务分割（Task Partitioning）
Fiber架构通过将渲染工作分解为多个小任务（称为"Fiber节点"），使得这些任务可以被中断和恢复。这意味着React可以在执行一个任务的过程中，根据需要暂停它，执行其他紧急任务（如高优先级的更新），然后再回来继续之前的任务。

2. 优先级（Prioritization）
每个Fiber节点都分配有一个优先级，React可以根据任务的紧急程度来决定执行的顺序。例如，用户界面的交互（如点击或输入）通常具有更高的优先级，而一些次要的更新（如数据加载完成后的渲染）优先级较低。

3. 并发（Concurrency）
Fiber架构支持并发执行多个任务。当一个高优先级的任务需要执行时，低优先级的任务可以被暂时挂起，直到高优先级任务完成。这通过使用浏览器的requestIdleCallback API来实现，该API允许React在浏览器空闲时执行工作。

4. 可中断的渲染
传统的React渲染是不可中断的，一旦开始就无法停止。Fiber架构通过将渲染过程拆分成多个小段，使得在渲染过程中可以根据需要暂停和恢复。例如，如果一个组件的渲染耗时较长，React可以在渲染到一半时暂停，处理其他紧急更新，然后再回来继续渲染剩余部分。

5. 调度（Scheduling）
Fiber引入了一个新的调度器（Scheduler），它负责管理和分配任务的优先级和执行时机。调度器会根据任务的优先级和浏览器的空闲时间来决定何时以及如何执行这些任务。

```